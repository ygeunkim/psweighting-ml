---
title: "Propensity Score Weighting"
subtitle: "using machine learning"
author: |
  | [Young Geun Kim](mailto:dudrms33@g.skku.edu)
  | [ygeunkim.github.io](https://ygeunkim.github.io)
institute: "2019711358, [Department of Statistics](https://stat.skku.edu/stat/index.jsp)"
date: "`r format(Sys.time(), '%d %b, %Y')`"
bibliography: "../docs/prop.bib"
output: 
  xaringan::moon_reader:
    nature:
      highlightLines: true
      highlightStyle: github
knit:
  (function(inputFile, encoding) {
    rmarkdown::render(input = inputFile, encoding = encoding, output_dir = "../static/slides")
  })
header-includes:
  - \usepackage{booktabs}
  - \usepackage{longtable}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage{wrapfig}
  - \usepackage{float}
  - \usepackage{colortbl}
  - \usepackage{pdflscape}
  - \usepackage{tabu}
  - \usepackage{threeparttable}
  - \usepackage{threeparttablex}
  - \usepackage[normalem]{ulem}
  - \usepackage[utf8]{inputenc}
  - \usepackage{makecell}
  - \usepackage{xcolor}
  - \usepackage{hyperref}
  - \usepackage{enumitem}
  - \usepackage[boxruled, linesnumbered]{algorithm2e}
  - \IncMargin{1.5em}
  - \newcommand{\iid}{\stackrel{iid}{\sim}}
  - \newcommand{\indep}{\stackrel{indep}{\sim}}
  - \newcommand{\hsim}{\stackrel{H_0}{\sim}}
  - \newcommand{\ind}{\perp\!\!\!\perp}
  - \newcommand{\R}{\mathbb{R}}
  - \newcommand{\B}{\boldsymbol\beta}
  - \newcommand{\hb}{\boldsymbol{\hat\beta}}
  - \newcommand{\E}{\boldsymbol\epsilon}
  - \newcommand{\defn}{\mathpunct{:}=}
  - \DeclareMathOperator*{\argmin}{argmin}
  - \DeclareMathOperator*{\argmax}{argmax}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE,
  out.width = "70%",
  fig.align = "center",
  fig.width = 6,
  fig.asp = .618,
  fig.pos = "H"
  )
knitr::knit_hooks$set(
  document = function(x) {
    sub("\\usepackage[]{color}", "\\usepackage{xcolor}", x, fixed = TRUE)
  }
)
options(digits = 3)
options(kableExtra.latex.load_packages = FALSE)
is_latex <- knitr::opts_knit$get("rmarkdown.pandoc.to") == "latex"
is_beamer <- knitr::opts_knit$get("rmarkdown.pandoc.to") == "beamer"
```

```{r, message=FALSE, echo=FALSE}
# tidyverse family---------------------
# cite---------------------------------
library(RefManageR)
# set seed for report -----------------
set.seed(1)
```

```{r, include=FALSE}
# bibtex------------------------------
bib <- ReadBib("../docs/prop.bib")
```

# Reviewed Paper

```{r, include=FALSE}
Citet(bib, "cmm")
```


```{r, message=FALSE, echo=FALSE, comment=NULL, results='asis'}
PrintBibliography(bib)
```

--

Instead of logistic regression:

- Random forests
- CART
- SVM

```{r}
library(propensityml)
```

See [https://github.com/ygeunkim/propensityml](https://github.com/ygeunkim/propensityml).

---

## Simulation study

```{r, include=FALSE}
Citet(bib, "utg")
```

```{r, message=FALSE, echo=FALSE, comment=NULL, results='asis'}
PrintBibliography(bib, start = 2)
```


--

- Confounders
- Exposure predictors
- Outcome predictors

```{r}
sim_covariate(1000, covmat = build_covariate())
```

---

## Scenarios

1. Additivity and linearity
2. Mild non-linearity: 1 quadratic term
3. Moderate non-linearity: 3 quadratic term
4. Mild non-additivity: 3 two-way interaction terms
5. Mild non-additivity and non-linearity: 3 two-way interaction terms and 1 quadratic term
6. Moderate non-linearity: 10 two-way interaction terms
7. Moderate non-additivity and non-linearity: 10 two-way interaction terms and 3 quadratic terms

## Small, Medium, and Large-sized Sets

```{r}
# n = 500
small <- sim_outcome(500, covmat = build_covariate())
# n = 1000
medium <- sim_outcome(1000, covmat = build_covariate())
# n = 2000
large <- sim_outcome(2000, covmat = build_covariate())
```

---

# Evaluation








